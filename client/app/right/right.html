<div class="rpanel-header">
    <div class="rpanel-header-heading">
        <!--TODO @filter: FILE TYPE DROPDOWN AND APPLY TO FILE FILTER-->
        <div class="rpanel-header-heading__types">
            <span class="dropdown-toggle cursor_pointer" data-toggle="dropdown" data-ng-switch="fileRequest.fileType | upperFirstCharacter">
                <span data-ng-switch-default>{{ 'All Files' | translate }}</span>
                <span data-ng-switch-when="Image">{{ 'Images' | translate }}</span>
                <span data-ng-switch-when="PDF">{{ 'PDF' | translate }}</span>
                <span data-ng-switch-when="Audio">{{ 'Audio' | translate }}</span>
                <span data-ng-switch-when="Video">{{ 'Video' | translate }}</span>
                <i class="rpanel-header-heading__types__more fa fa-caret-down"></i>
            </span>
            <ul class="dropdown-menu grey_dropdown rpanel-header-heading__types__dropdown" role="menu">
                <li role="presentation" data-ng-click="fileRequest.fileType = 'all'">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-files-o"></i>
                        <span translate>All Files</span>
                    </a>
                </li>
                <li role="presentation" data-ng-click="fileRequest.fileType = 'image'">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-file-image-o"></i>
                        <span translate>Images</span>
                    </a>
                </li>
                <li role="presentation" data-ng-click="fileRequest.fileType = 'pdf'">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-file-pdf-o"></i>
                        <span translate>PDF</span>
                    </a>
                </li>
                <li role="presentation" data-ng-click="fileRequest.fileType = 'audio'">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-file-audio-o"></i>
                        <span translate>Audio</span>
                    </a>
                </li>
                <li role="presentation" data-ng-click="fileRequest.fileType = 'video'">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-file-video-o"></i>
                        <span translate>Video</span>
                    </a>
                </li>
            </ul>
        </div>
        <div id="add_new_file" class="rpanel-header-heading__files dropdown">
            <span class="dropdown-toggle cursor_pointer rpanel-header-heading__files-add">
                <span class="icon_image icon_verti_menu rpanel-header-headding__files-add__more"></span>
                <span class="underline" translate>Upload File</span>
            </span>
            <ul class="dropdown-menu right-align grey_dropdown file-upload__dropdown" role="menu">
                <li role="presentation" class="file-upload__dropdown-list">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-file-o"></i>
                        <span translate>File</span>
                    </a>
                    <input type="file"
                           id="file_list_button"
                           class="cursor_pointer file_upload_btn float-right"
                           onclick="this.value=null"
                           data-ng-file-select="onFileSelect($files);"
                           defaultValue="File">
                </li>
                <li class="file-upload__dropdown-list" data-ng-if="false">
                    <a role="menuitem" tabindex="-1">
                        <i class="fa fa-file-text-o"></i>
                        <span>Post</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="rpanel-body" infinite-scroll-bottom="">
    <div class="rpanel-header-toolbar">
        <div class="rpanel-header-toolbar__users cursor_pointer">
            <span class="file-uploader-tab"
                  data-ng-model="tabIndicator"
                  btn-radio="'everyone'"
                  data-ng-click="onFileFilterWriterIdClick('all');">
                <span translate>EVERYONE</span>
            </span>
            <span class="file-uploader-tab"
                  data-ng-model="tabIndicator"
                  btn-radio="'notEveryone'"
                  data-default-value="{{ 'YOU' | translate }}"
                  data-ng-click="onFileFilterWriterIdClick(fileRequest.writerId=='all'?'mine':fileRequest.writerId);">
                {{ fileRequest.writerId | getFirstLastNameById }}
            </span>

            <span class="file-uploader-tab__more icon_add_member dropdown-toggle" data-toggle="dropdown"></span>
            <ul class="dropdown-menu grey_dropdown file-uploader-dropdown" role="menu">
                <li data-ng-repeat="user in userList" data-ng-animate="{enter: 'animate-enter', leave: 'animate-leave'}">
                    <!--<label class="btn" data-ng-click="onFileFilterWriterIdClick(user.id);">-->
                    <!--{{ user.name }}-->
                    <!--</label>-->
                    <a data-ng-click="onFileFilterWriterIdClick(user.id);">
                       {{ user|getFirstLastNameOfUser }}
                    </a>
                </li>
                <li data-ng-animate="{enter: 'animate-enter', leave: 'animate-leave'}">
                    <a data-ng-click="onFileFilterWriterIdClick(user.id);">
                        {{ user|getFirstLastNameOfUser }}
                    </a>

                </li>
            </ul>
        </div>

        <div class="rpanel-body-search input-group">
            <span class="input-group-addon">
                <span class="icon_image icon_search rpanel-body-search__icon"></span>
            </span>
            <input type="text"
                   class="form-control rpanel-body-search__input green-input-box"
                   placeholder="{{ 'Search by title' | translate }}"
                   data-ng-model="fileRequest.keyword">
        </div>

    </div>

    <div class="rpanel-body-content file-list" >

        <div class="file-list__item" data-ng-repeat="file in fileList" >

            <!-- FILE TYPE ICON IMAGE && FILE TYPE && FILE SIZE CONTAINER ON THE LEFT -->
            <div class="file-item-type">
                <div class="fileicon fileicon_{{ file.content.type | filetype | lowercase }}"></div>
                <div class="file-item-meta__type" data-ng-if="file.content.type">{{ file.content.type | filetype }}</div>
                <div class="file-item-meta__size" data-ng-if="file.content.size > 0">{{ file.content.size | bytes }}</div>
            </div>

            <!-- FILE AUTHOR(FILE UPLOADER) CONTAINER ON THE RIGHT -->
            <div class="file-item-body__author">
                <span ui-sref="archives({ entityType: 'users', entityId: file.writerId })" class="file-item-body-author cursor_pointer inline-overflow-ellipsis">
                    {{file.writer|getFirstLastNameOfUser }}
                </span>
            </div>

             <!-- OTHER INFORMATION ABOUT FILE: TITLE, UPLOADED TIME, SHARED CHANNELS, LINK TO NEW TAB -->
            <div class="file-item-body">

                <!-- FILE TITLE WITH DROPDOWN MENU -->
                <div class="file-item-body__title">
                    <span class="file-item-body-title cursor_pointer inline-overflow-ellipsis" ui-sref="files({ userName: file.writer.name, itemId: file.id })">
                        {{ file.content.title }}
                    </span>
                    <span class="file-item-body-title__more cursor_pointer" dropdown>
                        <a class="dropdown-toggle link-green">
                            <i class="fa fa-caret-down"></i>
                        </a>
                        <ul class="dropdown-menu grey_dropdown file_action_dropdown" role="menu">
                            <li class="cursor_pointer">
                                <a data-ng-click="onClickShare(file); toggleDropdown($event);">
                                    <i class="fa fa-share-alt"></i>
                                    <span translate>Share</span>
                                </a>
                            </li>
                            <li class="cursor_pointer">
                                <a data-ng-click="">
                                    <i class="fa fa-comment-o"></i>
                                    <span translate>Comment</span>
                                </a>
                            </li>
                            <li class="cursor_pointer">
                                <a href="{{ server_uploaded + file.content.fileUrl }}" download="{{ file.content.name }}">
                                    <i class="fa fa-download"></i>
                                    <span translate>Download</span>
                                </a>
                            </li>
                        </ul>
                    </span>
                </div>

                <!-- UPLOADED TIME, SHARED CHANNELS/PRIVATEGROUPS, LINK -->
                <div class="file-item-meta file-item-meta__listview">
                    <div class="file-item-meta__createtime file-item-meta__info">{{ file.createTime | date: 'yyyy. MM. dd. h:mm a' }}</div>

                    <div data-ng-if="file.shared.length" class="file-item-meta__info">
                        Shared in
                        <span data-ng-repeat="sharedEntity in filteredSharedFile = (file.shared | filter : {type:'!user'}) track by $index">
                            <span data-ng-hide="($index === 0)">, </span>
                            <span class="file-item-meta__shared cursor_pointer" data-ng-click="onClickSharedEntity(sharedEntity.id)">
                                {{ sharedEntity.prefix }}{{ sharedEntity.name }}
                            </span>
                            <a class="link-remove link-unshare cursor_pointer" data-ng-click="onClickUnshare(file.id, sharedEntity.id)">
                                <i class="fa fa-minus-circle"></i>
                            </a>
                        </span>
                        <span data-ng-show="file.shared.length != filteredSharedFile.length">
                            <span data-ng-show="filteredSharedFile.length != 0"> and </span>with users.
                        </span>
                    </div>

                    <div class="file-item-meta__empty file-item-meta__info" data-ng-hide="file.shareEntities.length != 0">
                        <span translate>File has not been shared in any other channels</span>
                    </div>

                    <div class="file-item-meta-open file-item-meta__info">
                        <a class="file-item-meta-open__public cursor_pointer" href="{{ server_uploaded + file.content.fileUrl }}" target="{{ server_uploaded + file.content.fileUrl }}">
                            <span translate>Open original</span>
                        </a>
                    </div>

                    <!--image thumbnail-->
                    <img class="file-item-body__type-image__thumb cursor_pointer"
                         data-ng-if="(file.content.type).indexOf('image') !== -1"
                         data-ng-src="{{ server_uploaded+file.content.extraInfo.largeThumbnailUrl }}"
                         data-ui-sref="files({ userName: file.writer.name, itemId: file.id })">
                </div>
            </div>
        </div>

        <div class="file-list__item loading" ng-if="isScrollLoading">
            <div class="loading_container_background scroll_loading_container_background" ng-if="isLoading"></div>
            <div class="loading_bg scroll_loading_bg"></div>
            <div class="loading_bar scroll_loading_bar"></div>
        </div>

        <div ng-show="fileList.length==0">
            <div ng-if="fileRequest.keyword == ''" class="rpanel-body-content__result-msg">
                <span translate>No files uploaded</span>
            </div>
            <div ng-if="fileRequest.keyword != ''" class="rpanel-body-content__result-msg">
                <span translate>No files found matching on</span> <strong>{{ fileRequest.keyword }}</strong>
            </div>
        </div>

        <div class="loading_container file" ng-if="isLoading">
            <div class="loading_container_background file" ng-if="isLoading"></div>
            <div class="loading_bg file"></div>
            <div class="loading_bar file"></div>
        </div>

    </div>
</div>
