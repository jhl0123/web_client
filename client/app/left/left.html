<div ng-include="templates.loading"></div>
<div class="opac-zero" ng-class="{'opac-in': isReady }">

    <aside class="lpanel">

        <!-- USER INFO CONTAINER -->
        <div class="lpanel-user cursor_pointer" ng-click="onCurrentMemberContainerClick();">
        <span data-toggle="dropdown">
            <img class="lpanel-user__avatar opac-zero" on-image-load data-ng-src="{{ member | getSmallThumbnail }}">
            <div class="lpanel-user__container">
                <span class="lpanel-user__name inline-overflow-ellipsis"><b>{{team.name}}</b><br/>
                    {{ member | getUserPosition }} {{ member | getName}}</span>
            </div>
            <i class="fa fa-caret-up lpanel-user__more hidden"></i>
        </span>
        </div>

        <div class="tutorial-clicker tutorial-z-index pulse" id="topicTutorial" data-ng-click="onTutorialPulseClick($event);"
             data-ng-if="!tutorialStatus.topicTutorial"></div>

        <!-- LIST CONTAINER -->
        <div class="lpanel-list">

            <!-- TOPICS -->
            <div class="lpanel-list__topics">
                <!--    HEADER  -->
                <div class="lpanel-list__header cursor_pointer" ng-click="leftListCollapseStatus.isTopicsCollapsed = !leftListCollapseStatus.isTopicsCollapsed">
                    <i class="lpanel-list-left icon-topic-fill"></i>

                    <span class="lpanel-list__title inline-overflow-ellipsis" translate>@common-topics</span>

                    <div class="lpanel-list-option pull-right" ng-click="openModal('channel'); $event.stopPropagation(); $event.preventDefault();">
                        <i class="icon-add"></i><span translate>@common-add</span>
                    </div>
                    <div class="lpanel-list-option pull-right" ng-click="openModal('join'); $event.stopPropagation(); $event.preventDefault();">
                        <i class="icon-list"></i><span translate>@common-more</span>
                    </div>

                </div>

                <!--    LIST    -->
                <ul id="topics-list" collapse="leftListCollapseStatus.isTopicsCollapsed">

                    <li ng-repeat="joinedEntity in joinEntities | orderBy: ['isStarred', '-name']: true" ng-class="{active: $state.params.entityId == joinedEntity.id}">
                        <a ui-sref="archives({entityType:joinedEntity.type, entityId:joinedEntity.id})" data-channel-id="{{joinedEntity.id}}">

                            <i class="icon-star left-star" ng-class="{'icon-star-fill': joinedEntity.isStarred}"
                               data-ng-click="onStarClick(joinedEntity.type, joinedEntity.id); $event.preventDefault(); $event.stopPropagation();"></i>

                            <span class="inline-overflow-ellipsis left-panel__name" ng-class="{'has-unread-msg': joinedEntity.alarmCnt > 0}">
                                <span class="private-topic-icon" ng-if="joinedEntity.type=='privategroups'"></span>
                                {{joinedEntity.name}}
                            </span>

                            <span class="badge left-panel_badge green_badge pull-right">{{joinedEntity.alarmCnt}}</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- DIRECT MESSAGES    -->
            <div class="lpanel-list__users">

                <!--    HEADER  -->
                <div class="lpanel-list__header cursor_pointer" ng-click="leftListCollapseStatus.isDMCollapsed = !leftListCollapseStatus.isDMCollapsed">
                    <i class="lpanel-list-left icon-user"></i>
                    <span class="lpanel-list__title inline-overflow-ellipsis" translate>@common-direct-messages</span>
                </div>

                <!--    LIST    -->
                <ul id="dm-list" collapse="leftListCollapseStatus.isDMCollapsed">
                    <div class="lpanel-list-user_search">
                        <i class="icon-search absolute-search-icon"></i>
                        <input type="text"
                               class="form-control lpanel-list-user-search__box"
                               placeholder=""
                               data-ng-model="userNameQuery"
                               data-ng-focus="onDMInputFocus();"
                               data-ng-blur="onDMInputBlur();"/>
                    </div>

                    <li class="member cursor_pointer" ng-repeat="userEntity in visibleUsers = (memberList | orderBy: ['isStarred', '-name']: true | userByName:userNameQuery)"
                        ng-class="{active: $state.params.entityId == userEntity.id}">

                        <a ui-sref="archives({entityType:'users',entityId: userEntity.id})" data-member-id="{{userEntity.id}}">
                            <i class="icon-star left-star" ng-class="{'icon-star-fill': userEntity.isStarred}"
                               data-ng-click="onStarClick(userEntity.type, userEntity.id); $event.preventDefault(); $event.stopPropagation();"></i>

                            <span class="inline-overflow-ellipsis left-panel__name" ng-class="{'has-unread-msg': userEntity.alarmCnt > 0}">{{userEntity | getName}}</span>
                            <span class="badge left-panel_badge green_badge pull-right">{{userEntity.alarmCnt}}</span>
                        </a>
                    </li>
                </ul>

                <div class="clear-both"></div>
            </div>

        </div>
    </aside>

    <div ui-view="centerpanel" class="cpanel" ng-class="{'rpanel-show': $state.includes('**.files.**')}"></div>

</div>


<span ng-if="false">
    <span translate>@channel</span>
    <span translate>@user</span>
    <span translate>@privateGroup</span>
    <span translate>@file-size-too-large-error</span>
    <span translate>@common-api-error-msg</span>
</span>
